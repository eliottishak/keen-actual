{{ 'section-popular-products.css' | asset_url | stylesheet_tag }}
{{ 'component-card.css' | asset_url | stylesheet_tag }}

<script src="{{ 'popular-products.js' | asset_url }}" defer="defer"></script>

{%- style -%}
  {% render 'section-padding' %}
  {% render 'section-margin' %}
{%- endstyle -%}

{%- style -%}
  .section-{{ section.id }}-padding .popular-products__grid {
    --row_gap: {{ section.settings.row_gap }}rem;
    --column_gap: {{ section.settings.column_gap }}rem;
  }
  .popular-products__item .card-information__wrapper .card__title {
    color: {{ section.settings.color_title }}
  }
  .popular-products__item .card-information__wrapper .price-item  {
    color: {{ section.settings.color_description }}
  }
{%- endstyle -%}

<div
  id="row-{{ section.id }}"
  class="popular-products color-{{ section.settings.color_scheme }} background section-{{ section.id }}-padding {% if section.settings.mobile_slider_layout_type == 'visible_overflow' %} popular-products--visible-overflow{% endif %}"
  data-layout="{{ section.settings.cards_layout }}"
  data-layout-mobile="{{ section.settings.mobile_cards_layout }}"
>
  <div class="popular-products__top container">
    <div class="popular-products__top-main">
      {% render 'heading-group', section: section, class: 'popular-products', text_align: 'left' %}
    </div>
  </div>
  <div class="popular-products__wrapper container content">
    {% comment %} <div class="popular-products__layout{% if section.settings.mobile_slider_layout_type == 'visible_overflow' %} popular-products__layout--visible-overflow{% endif %}{% if section.settings.animate_on_scroll %} animate-on-scroll{% endif %}">
      <div
        class="
          popular-products__list content
          popular-products__{{ section.settings.cards_layout }}
          popular-products__{{ section.settings.mobile_cards_layout }}
          {% if section.settings.cards_layout == 'grid' %} grid--{{ section.settings.products_to_show }} {% endif %}
          list-unstyled
        "
      >
        {% assign product_list = section.settings.product_list %}
        {% assign product_count = 0 %}

        {% for product in product_list %}
          {% assign product_count = product_count | plus: 1 %}
        {% endfor %}

        {% liquid
          assign anim_delay_coeff = 0.1

          if product_count > 12
            assign anim_delay_coeff = 0.05
          endif

          if product_count > 24
            assign anim_delay_coeff = 0.025
          endif
        %}
        {%- for product in section.settings.product_list -%}
          <div
            class="popular-products__item collection-product-card{% if settings.quickview_hover %} quickview--hover{% endif %}"
            style="--pop-prod-item-delay: {{ forloop.index |  minus: 1 | times: anim_delay_coeff }}s;"
          >
            {% if section.settings.cards_layout == 'bar' %}
              {% assign columns = 4 %}
            {% else %}
              {% assign columns = section.settings.products_to_show %}
            {% endif %}

            {% render 'cro-product-card',
              product_card_product: product,
              media_ratio: section.settings.image_ratio,
              media_fit: section.settings.image_fit,
              show_secondary_image: section.settings.show_secondary_image,
              show_vendor: section.settings.show_vendor,
              show_desc: section.settings.show_desc,
              section_id: section.id,
              add_id: forloop.index,
              columns: columns
            %}
          </div>
        {%- else -%}
          {%- for i in (1..5) -%}
            <div
              class="
                popular-products__item
                popular-products__item_placeholder collection-popular-card collection-popular-card--placeholder
              "
              style="--pop-prod-item-delay: {{ forloop.index |  minus: 1 |  times: 0.1 }}s;"
            >
              {% render 'product-card-placeholder',
                media_ratio: section.settings.image_ratio,
                show_vendor: section.settings.show_vendor,
                product_number: 3
              %}
            </div>
          {%- endfor -%}
        {%- endfor -%}
      </div>
    </div> {% endcomment %}
    <style>
      .cro-product-row {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 10px;
}

.cro-product-card {
  padding: 30px 15px;
  background: #fff;
  border: 2px solid black;
  border-radius: 20px;
  display: flex;                 /* enable flex */
  flex-direction: column;
  align-items: center;
  overflow: hidden;
  width: 100%;
  gap: 33px;
  height: 100%;      
  transition:0.5s;            /* allow stretching */
}
.cro-product-card:hover .product-view-btn{
  transition:0.5s;
}
.cro-product-card img {
  width: 100%;
}

.cro-product-card .card-title-cro {
  flex-grow: 1;                  /* equalize height so buttons align at bottom */
  text-align: center;
  font-size: 27px;
  font-weight: 700;
  line-height: 28px;
  text-transform: uppercase;
  z-index: 1;
}

.cro-product-card .product-view-btn {
  border-radius: 55px;
  background: #23E129;
  color: #000;  
  font-size: 16px;
  border: 2px solid black;
  padding: 13px;
  font-weight: bolder;
  width: 100%;
  text-align: center;
  box-shadow: 0px 4px 0 #000;
  z-index: 9;
}
.popular-products__top-main {
    display: flex;
    width: 100%;
    justify-content: space-between;
    align-items: center;
}
.popular-products__top-main .description{
  margin-top:0;
}
.popular-products__top-main .description{
  margin-top:0;
  width:400px;
  font-size:16px;
  line-height:23px;
}
@media (max-width: 991px) {
  #row-{{section.id}} h2.popular-products__title.title.h3.size--h3{
    text-align:center;
    font-size:35px;
    margin-top:70px;
  }
  .popular-products__top-main{
    display:block;
  }
  .popular-products__top-main .description{
    width:100%;
    text-align:center;
    font-size:15px;
    padding:0 27px;
  }
  .cro-product-row {
    grid-template-columns: repeat(2, 1fr);
  }
  .cro-product-card img{
    transform:scale(1.3);
  }
  .cro-product-card .card-title-cro{
    color: #000;
    text-align: center;
    font-size: 19px;
    font-style: normal;
    font-weight: 700;
    line-height: 17px; /* 89.474% */
    text-transform: uppercase;
  }
}


</style>
    <div class="cro-product-row">
      {% for product in section.settings.product_list %}
         {% render 'cro-product-card' product:product %}
      {% endfor %}
    </div>
    {%- if section.settings.button_show -%}
      {% render 'button',
        btn_label: section.settings.button_label,
        btn_style: section.settings.button_style,
        btn_link: section.settings.button_link,
        btn_arrow: section.settings.button_arrow,
        class: 'popular-products__button'
      %}
    {%- endif -%}
  </div>

  {%- if section.settings.mobile_cards_layout == 'slider'
    and section.settings.mobile_slider_layout_type == 'with_arrows'
  -%}
    <div class="popular-products__navigation container no-js-hidden">
      <button class="popular-products__navigation-button popular-products__navigation-button-prev swiper-button-prev">
        {% render 'icon-btn-arrow' %}
      </button>
      <button class="popular-products__navigation-button popular-products__navigation-button-next swiper-button-next">
        {% render 'icon-btn-arrow' %}
      </button>
    </div>
  {%- endif -%}

  {%- if section.settings.cards_layout == 'bar' -%}
    <div class="popular-products__bar-container container no-js-hidden">
      <div class="popular-products__bar swiper-scrollbar"></div>
    </div>
  {%- endif -%}
</div>

{% schema %}
{
  "name": "Popular Products CRO",
  "tag": "section",
  "class": "popular-products-section",
  "disabled_on": {
    "templates": ["password"],
    "groups": ["*"]
  },
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "default": "background-1",
      "label": "t:sections.all.color_scheme.label"
    },
    {
      "type": "checkbox",
      "id": "animate_on_scroll",
      "label": "t:sections.all.animate_on_scroll.label",
      "info": "t:sections.all.animate_on_scroll.info",
      "default": true
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "t:sections.all.subheading.label"
    },
    {
      "type": "inline_richtext",
      "id": "heading",
      "default": "Some heading",
      "label": "t:sections.all.heading.label"
    },
    {
      "type": "select",
      "id": "heading_size",
      "options": [
        {
          "value": "h3",
          "label": "t:sections.all.heading_size.options__1.label"
        },
        {
          "value": "h2",
          "label": "t:sections.all.heading_size.options__2.label"
        }
      ],
      "default": "h3",
      "label": "t:sections.all.heading_size.label"
    },
    {
      "type": "inline_richtext",
      "id": "description",
      "label": "t:sections.all.text.label"
    },
    {
      "type": "product_list",
      "id": "product_list",
      "label": "t:sections.popular-products.settings.product_list.label"
    },
    {
      "type": "color",
      "id": "color_title",
      "label": "Title color"
    },
    {
      "type": "color",
      "id": "color_description",
      "label": "Description color"
    },
    {
      "type": "select",
      "id": "cards_layout",
      "label": "t:sections.popular-products.settings.cards_layout.label",
      "options": [
        {
          "value": "bar",
          "label": "t:sections.popular-products.settings.cards_layout.options__1.label"
        },
        {
          "value": "grid",
          "label": "t:sections.popular-products.settings.cards_layout.options__2.label"
        }
      ],
      "default": "bar"
    },
    {
      "type": "select",
      "id": "mobile_cards_layout",
      "label": "t:sections.popular-products.settings.mobile_cards_layout.label",
      "options": [
        {
          "value": "slider",
          "label": "t:sections.popular-products.settings.mobile_cards_layout.options__2.label"
        },
        {
          "value": "column",
          "label": "t:sections.popular-products.settings.mobile_cards_layout.options__3.label"
        }
      ],
      "default": "slider"
    },
    {
      "type": "select",
      "id": "mobile_slider_layout_type",
      "options": [
        {
          "value": "visible_overflow",
          "label": "t:sections.all.mobile_slider_layout_type.options__1.label"
        },
        {
          "value": "with_arrows",
          "label": "t:sections.all.mobile_slider_layout_type.options__2.label"
        }
      ],
      "default": "visible_overflow",
      "label": "t:sections.all.mobile_slider_layout_type.label"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "info": "t:sections.popular-products.settings.products_to_show.info",
      "min": 1,
      "max": 4,
      "step": 1,
      "default": 4,
      "label": "t:sections.popular-products.settings.products_to_show.label"
    },
    {
      "type": "select",
      "id": "column_gap",
      "label": "t:sections.image-multicolumn.settings.column_gap.label",
      "options": [
        {
          "value": "0.8",
          "label": "t:sections.image-multicolumn.settings.column_gap.options__3.label"
        },
        {
          "value": "1.6",
          "label": "t:sections.image-multicolumn.settings.column_gap.options__2.label"
        },
        {
          "value": "2.4",
          "label": "t:sections.image-multicolumn.settings.column_gap.options__1.label"
        }
      ],
      "default": "1.6"
    },
    {
      "type": "select",
      "id": "row_gap",
      "label": "t:sections.image-multicolumn.settings.row_gap.label",
      "options": [
        {
          "value": "0.8",
          "label": "t:sections.image-multicolumn.settings.row_gap.options__3.label"
        },
        {
          "value": "2.4",
          "label": "t:sections.image-multicolumn.settings.row_gap.options__2.label"
        },
        {
          "value": "4",
          "label": "t:sections.image-multicolumn.settings.row_gap.options__1.label"
        }
      ],
      "default": "4"
    },
    {
      "type": "select",
      "id": "image_ratio",
      "options": [
        {
          "value": "landscape",
          "label": "t:sections.all.card.image_ratio_2.options__1.label"
        },
        {
          "value": "portrait",
          "label": "t:sections.all.card.image_ratio_2.options__2.label"
        },
        {
          "value": "square",
          "label": "t:sections.all.card.image_ratio_2.options__3.label"
        }
      ],
      "default": "portrait",
      "label": "t:sections.popular-products.settings.image_ratio.label"
    },
    {
      "type": "select",
      "id": "image_fit",
      "label": "t:sections.all.card.image_fit.label",
      "options": [
        {
          "value": "contain",
          "label": "t:sections.all.card.image_fit.options__1.label"
        },
        {
          "value": "cover",
          "label": "t:sections.all.card.image_fit.options__2.label"
        }
      ],
      "default": "cover"
    },
    {
      "type": "checkbox",
      "id": "show_secondary_image",
      "default": true,
      "label": "t:sections.all.card.show_secondary_image.label",
      "info": "t:sections.all.card.show_secondary_image.info"
    },
    {
      "type": "checkbox",
      "id": "show_vendor",
      "default": false,
      "label": "t:sections.all.card.show_vendor.label"
    },
    {
      "type": "checkbox",
      "id": "show_desc",
      "default": false,
      "label": "t:sections.all.card.show_desc.label",
      "info": "t:sections.all.card.show_desc.info"
    },
    {
      "type": "header",
      "content": "t:sections.all.button.header_button.content"
    },
    {
      "type": "checkbox",
      "id": "button_show",
      "default": true,
      "label": "t:sections.all.button.button_show.label"
    },
    {
      "type": "text",
      "id": "button_label",
      "default": "Button label",
      "label": "t:sections.all.button.button_label.label"
    },
    {
      "type": "select",
      "id": "button_style",
      "options": [
        {
          "value": "primary",
          "label": "t:sections.all.button.button_style.options__1.label"
        },
        {
          "value": "secondary",
          "label": "t:sections.all.button.button_style.options__2.label"
        },
        {
          "value": "tertiary",
          "label": "t:sections.all.button.button_style.options__3.label"
        }
      ],
      "default": "primary",
      "label": "t:sections.all.button.button_style.label"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "t:sections.all.button.button_link.label"
    },
    {
      "type": "checkbox",
      "id": "button_arrow",
      "default": true,
      "label": "t:sections.all.button.button_arrow.label"
    },
    {
      "type": "header",
      "content": "t:sections.all.section-padding.header.content"
    },
    {
      "type": "select",
      "id": "padding_top",
      "options": [
        {
          "value": "no-indent",
          "label": "t:sections.all.section-padding.options__1.label"
        },
        {
          "value": "xs",
          "label": "t:sections.all.section-padding.options__2.label"
        },
        {
          "value": "s",
          "label": "t:sections.all.section-padding.options__3.label"
        },
        {
          "value": "m",
          "label": "t:sections.all.section-padding.options__4.label"
        },
        {
          "value": "l",
          "label": "t:sections.all.section-padding.options__5.label"
        },
        {
          "value": "xl",
          "label": "t:sections.all.section-padding.options__6.label"
        }
      ],
      "default": "no-indent",
      "label": "t:sections.all.section-padding.padding_top.label"
    },
    {
      "type": "select",
      "id": "padding_bottom",
      "options": [
        {
          "value": "no-indent",
          "label": "t:sections.all.section-padding.options__1.label"
        },
        {
          "value": "xs",
          "label": "t:sections.all.section-padding.options__2.label"
        },
        {
          "value": "s",
          "label": "t:sections.all.section-padding.options__3.label"
        },
        {
          "value": "m",
          "label": "t:sections.all.section-padding.options__4.label"
        },
        {
          "value": "l",
          "label": "t:sections.all.section-padding.options__5.label"
        },
        {
          "value": "xl",
          "label": "t:sections.all.section-padding.options__6.label"
        }
      ],
      "default": "xl",
      "label": "t:sections.all.section-padding.padding_bottom.label"
    },
    {
      "type": "header",
      "content": "t:sections.all.section-margin.header.content"
    },
    {
      "type": "select",
      "id": "margin_top",
      "options": [
        {
          "value": "no-indent",
          "label": "t:sections.all.section-margin.options__1.label"
        },
        {
          "value": "xs",
          "label": "t:sections.all.section-margin.options__2.label"
        },
        {
          "value": "s",
          "label": "t:sections.all.section-margin.options__3.label"
        },
        {
          "value": "m",
          "label": "t:sections.all.section-margin.options__4.label"
        },
        {
          "value": "l",
          "label": "t:sections.all.section-margin.options__5.label"
        },
        {
          "value": "xl",
          "label": "t:sections.all.section-margin.options__6.label"
        }
      ],
      "default": "no-indent",
      "label": "t:sections.all.section-margin.margin_top.label"
    },
    {
      "type": "select",
      "id": "margin_bottom",
      "options": [
        {
          "value": "no-indent",
          "label": "t:sections.all.section-margin.options__1.label"
        },
        {
          "value": "xs",
          "label": "t:sections.all.section-margin.options__2.label"
        },
        {
          "value": "s",
          "label": "t:sections.all.section-margin.options__3.label"
        },
        {
          "value": "m",
          "label": "t:sections.all.section-margin.options__4.label"
        },
        {
          "value": "l",
          "label": "t:sections.all.section-margin.options__5.label"
        },
        {
          "value": "xl",
          "label": "t:sections.all.section-margin.options__6.label"
        }
      ],
      "default": "no-indent",
      "label": "t:sections.all.section-margin.margin_bottom.label"
    }
  ],
  "presets": [
    {
      "name": "Popular Products CRO"
    }
  ]
}

{% endschema %}
